---
title: "ODOTCOMM18"
author: "Megan Hepner"
date: "March 16, 2018"
output: html_document
---

# Louisiana Saltmarsh-Mangrove Ecotone Interactive Infographic 

### Developed by Megan Hepner, Paige Byerly, and Bethann Garramon Merkle at [OceanDotComm](https://lumcon.edu/oceandotcomm/), a science commmunication workshop, supported by the Louisiana Universities Marine Consortium (LUMCON). 

### Objective: Develop an interactive infographic of the Louisiana bayou saltmarsh ecotone with enganging narrative to depict what the status and trend of key ecosystem species. 

| Species Classification | Icon                 | Metric                | Data    |
|:-----------------------|----------------------|-----------------------|-------- |
| Focal                  | Blue Crabs           | pounds, dollars       | NMFS    |
| Focal                  | Shrimp               | pounds, dollars       | NMFS    |
| Focal                  | Birds                | diversity, abundance  | eBIRD   |
| Focal                  | Seaside Sparrow      | abundance             | eBIRD   |
| Focal                  | Forester's Tern      | abundance             | eBIRD   | 
| Focal                  | Snappers             | pounds, dollars       | NMFS    |
| Focal                  | Drums                | pounds, dollars       | NMFS    |
| Foundation             | Oyster Reefs         | pounds, dollars       | CIMS    |
| Foundation             | Marsh grass          | Mean percent cover    | CIMS    |
| Foundation             | Black Mangrove       | Mean percent cover    | CIMS    |
| Invasive               | Nutria               | Harvested tail        |         |
| Focal                  | Diamondback Terrapin | NA                    | No data |
| Focal                  | Bottlenose dolphin   | NA                    | No data |
| Focal                  | Cocahoe              | NA                    | No data |
| Focal                  | Fidler crab          | NA                    | No dara |
| Focal                  | Periwinkle snails    | NA                    | No data | 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(vegan)
library(infographiq)
library(ggplot2)
library(brew)
library(dygraphs)
library(lubridate)
library(servr)
library(rmarkdown)
library(stringr)
library(tools)
library(xts)
library(RColorBrewer)
library(geojsonio)

```

#Blue Crabs 
Data refernce: NMFS Science and Technology <https://www.st.nmfs.noaa.gov/pls/webpls/MF_ANNUAL_LANDINGS.RESULTS> 
```{r Blue Crabs}
blue_crab = read_csv("prep/data/crabs_nmfs.csv") 
```

#Shrimp 
Data reference: NMFS Science and Technology <https://www.st.nmfs.noaa.gov/pls/webpls/MF_ANNUAL_LANDINGS.RESULTS>
Species: Brown Shrimp, Pink Shrimp, Rock Shrimp, Royal Red Shrimp, Seabob Shrimp, White Shrimp, Roughneck Shrimp

```{r Shrimp}
shrimp = read_csv("prep/data/shrimp_nmfs.csv") 

commercialized_shrimp = shrimp %>%
  filter(Species != "Pink Shrimp") %>%
  filter(Species != "Rock Shrimp") %>%
  filter(Species != "Royal Red Shrimp")%>%
  filter(Species != "Roughneck Shrimp")

write_csv(commercialized_shrimp, "prep/data/commercialized_shrimp_nmfs.csv")
```

#Saltmarsh Vegetarian 
Data reference: CIMS   <https://cims.coastal.louisiana.gov/fulltableexports.aspx> 
Species: smooth cordgrass, common reed, saltgrass, saltmeadow cordgrass, turtleweed, needlegrass rush
```{r Saltmarsh Vegetation}

saltmarsh = read_csv("prep/data/salt_marsh_vegetation_all_cims.csv") #tibble: 36,567 x 30
#unique(saltmarsh$Community) "Saline"
#unique(saltmarsh$Sample_Type) "Random","Transect",Stratified"
#unique(saltmarsh$Vegetation_Type) "Natural" "Planted" NA
#unique(saltmarsh$`Plot_Size_(m2)`) 4.00  2.00  1.00  0.25 37.12 25.00  3.00  0.00
#unique(saltmarsh$In_Out) "Out"  "Both" "In"   NA 
#unique(saltmarsh$Organization)
#  [1] "LA DEPT OF NAT RES (CRDT)"                   
#  [2] "LA DEPT OF NAT RES (CRDNO)"                  
#  [3] "GEC"                                         
#  [4] "LA DEPT OF NAT RES (CRDL)"                   
#  [5] "COASTAL ESTUARY SERVICES LLC"                
#  [6] "COASTAL PROTECTION AND RESTORATION AUTHORITY"
#  [7] "GULF ENGINEERS & CONSULTANTS"                
#  [8] "BIOLOGICAL MONITORING SECTION (NO)"          
#  [9] "U.S. GEOL SURVEY (USGS)"                     
# [10] "LA DEPT OF NAT RES (CMDB)"                   
# [11] "UNIV OF NEW ORLEANS"

saltmarsh_year_transect = saltmarsh %>%
  mutate(Year = format(as.Date(saltmarsh$Collection_Date, format='%m/%d/%Y'), "%Y")) %>%
  filter(Sample_Type == "Transect") %>% 
  select(Year, Sample_Type, Common_Name_As_Originally_Observed, Scientific_Name_As_Currently_Recognized, Percent_Cover_Total) %>%
  filter(Percent_Cover_Total != "<1") %>%
  group_by(Year, Common_Name_As_Originally_Observed, Scientific_Name_As_Currently_Recognized) %>%
  mutate(Percent_Cover_Total = as.numeric(Percent_Cover_Total)) %>% 
  summarize(percent_cover_mean = mean(Percent_Cover_Total)) %>%
  mutate(percent_cover_mean =round(percent_cover_mean, 0))

write_csv(saltmarsh_year_transect, "prep/data/saltmarsh_year_transect.csv")

saltmarsh_year_transect = read_csv("prep/data/saltmarsh_year_transect.csv")

spartina_transect = saltmarsh_year_transect %>%
  filter(Common_Name_As_Originally_Observed == "smooth cordgrass")
write_csv(spartina_transect, "prep/data/spartina_transect.csv")
#ggplot(data =spartina_transecrt, aes(x=Year, y=percent_cover_mean))+geom_point()+ggtitle("Spartina Percent Cover")+ylab("Mean % Cover")

phragmites_transect = saltmarsh_year_transect%>%
  filter(Common_Name_As_Originally_Observed == "common reed")
write_csv(phragmites_transect, "prep/data/phragmites_transect.csv")
#ggplot(data =phragmites_trasect, aes(x=Year, y=percent_cover_mean))+geom_point()+ggtitle("Phragmites Percent Cover")+ylab("Mean % Cover")

black_mangroves_transect = saltmarsh_year_transect%>%
  filter(Common_Name_As_Originally_Observed ==  "black mangrove")
write_csv(black_mangroves_transect, "prep/data/black_mangroves_transect.csv")

#ggplot(data =black_mangroves_trasect, aes(x=Year, y=percent_cover_mean))+ geom_point()+ggtitle("Black Mangrove Percent Cover")+ ylab("Mean % Cover")

marsh = read_csv("prep/data/vegetation_common_random_cims_cleaned.csv")
vegetation = marsh %>%
  select(Year, Common_Name, Scientific_Name, Percent_Cover_Total) %>%
  group_by(Year, Common_Name, Scientific_Name) %>%
  summarize(percent_cover_mean = mean(Percent_Cover_Total))
write_csv(vegetation, "prep/data/vegetation_summarized.csv")

spartina = vegetation %>%
  filter(Common_Name == "smooth cordgrass")
write_csv(spartina, "prep/data/spartina_cims.csv")

phragmites = vegetation%>%
  filter(Common_Name == "common reed")
write_csv(phragmites, "prep/data/phragmites_cims.csv")

black_mangroves = read_csv("prep/data/black_mangroves_cims.csv")
black_mangroves = black_mangroves %>%
  select(Year, Common_Name, Scientific_Name, Percent_Cover_Total) %>%
  group_by(Year, Common_Name, Scientific_Name) %>%
  summarize(percent_cover_mean = mean(Percent_Cover_Total))
write_csv(black_mangroves,"prep/data/black_mangroves_summarized.csv")

```

#Oytster Reefs 
Data reference: NMFS Science and Technology <https://www.st.nmfs.noaa.gov/pls/webpls/MF_ANNUAL_LANDINGS.RESULTS>
```{r Oyster Reefs}
oyster = read_csv("prep/data/oyster_nmfs.csv")
```

#Birds
Data reference: ebirds 
```{r Birds}

```

#Nutria 
Data reference:
```{r Nutria}
nutria = read_csv("prep/data/nutria_summarized.csv")
```

#Fish
Data reference: NMFS Science and Technology
Snapper Species: Black Snapper, Blackfin Snapper, Gray Snapper, Lane Snapper, Mutton Snapper, Queen Snapper, Red Snapper, Silk Snapper, Vermilion Snapper, Yellowtail Snapper
Drums: Red Drum, Black Drum 
```{r Fish}
snappers = read_csv("prep/data/snapper_nmfs.csv")
drums = read_csv("prep/data/drums_nmfs.csv")
```
